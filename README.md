# DNAalignment

DNA配列の類似度を表すStar法を用いた多重アラインメントの計算とアラインメントの描画

- 他の配列に対する類似性スコアが最も高い配列をみつけ、その配列を基準としてアラインメント
- スコアの計算において、2つの文字間のスコアを計算
- 同じ文字であれば2点、異なる文字であれば-1点、ギャップを-1点として計算します。また、どちらもギャップの場合は0点とする
- 文字列の長さが揃うように適宜”-“を用いることによってアラインメントの描画を行う


コードの全体的な流れとして、他の配列に対する類似性が最も高い配列をみつけ、その配列を基準としてアラインメントを行った。
7行目から20行目において、2つの文字間のスコアを計算する関数pair scoreを定義した。今回、同じ文字であれば2点、異なる文字であれば-1 点、ギャップを-1点として計算した。また、どちらもギャップの場合は0点とした。

22行目から39行目において、与えられた2つの遺伝子配列のアラインメントの最大スコアを計算する関数 calculate を定義した。
この際、DP表を用いて、再帰的に最大スコアを求めた。

41行目から107行目において、与えられた2つの遺伝子配列をアラインメントする関数alignmentを定義した。
まず、calculate関数と同様に、スコアを最大にするように DP表を作成し、その後DP表の制作手順を配列howに保存し、
逆からたどることでアラインメントを求めた。


110 行目以降にStar法のメインの実装を行った。
まず、110行目から118行目においてアラインメントする配列の本数numberとアラインメントする配列pre sequencesを読み込んだ。

次に、122行目から143行目において、全ての配列のペア間の類似性スコアを計算し、最も他の配列との類似性スコアが大きい配列
max seqを求めた。

次に、152行目から164行目において、配列max seqと他の配列をそれぞれアラインメントし、 配列ans sequencesに追加した。
その際、中心とする配列がアラインメントするごとに別の場所に’-’ が含まれ、アラインメントがうまくいかなくなる。そのため、中心とする配列がどの配列とアライ ンメントしたときに、どこに’-’ が含まれるかが分かるよう、配列 bar save に記録した。
次に、166行目から171行目において、先ほど記憶した’-’ の位置を他の配列に適応し、
アラインメント後の配列が全て同じ長さになるようにした。ここで多重アラインメントが完成した。

174行目から179行目において、多重アラインメントのスコアの計算方法に従ってスコアを計算した。
最後に、181行目から186行目において、結果を出力した。
